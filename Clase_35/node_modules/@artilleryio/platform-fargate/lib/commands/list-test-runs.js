
module.exports = { listTestRuns: listTestRunsCommand };

const debug = require('debug')('commands:list-test-runs');

const { listTestRuns } = require('../data-api/list-test-runs');
const { parseTags } = require('../tags');

const setDefaultAWSCredentials = require('../utils/aws-set-default-credentials');
const normalizeCLIFlags = require('../utils/normalize-cli-flags');

async function listTestRunsCommand(options) {
  normalizeCLIFlags(['max-items'], options);

  const tags = parseTags(options.tags);
  debug({tags});

  try {
    await setDefaultAWSCredentials();

    const results = await listTestRuns(tags, options.maxItems, options.offset);
    console.log(JSON.stringify(results, null, 4));
  }
  catch (err) {
    console.error('Something went wrong');
    console.error(err);
    process.exit(1);
  }
}
